{"ast":null,"code":"import AnalyticLightNode from './AnalyticLightNode.js';\nimport { lightTargetDirection } from './LightNode.js';\nimport { addLightNode } from './LightsNode.js';\nimport { getDistanceAttenuation } from './LightUtils.js';\nimport { uniform } from '../core/UniformNode.js';\nimport { smoothstep } from '../math/MathNode.js';\nimport { objectViewPosition } from '../accessors/Object3DNode.js';\nimport { positionView } from '../accessors/PositionNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { SpotLight } from 'three';\nclass SpotLightNode extends AnalyticLightNode {\n  constructor() {\n    let light = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    super(light);\n    this.coneCosNode = uniform(0);\n    this.penumbraCosNode = uniform(0);\n    this.cutoffDistanceNode = uniform(0);\n    this.decayExponentNode = uniform(0);\n  }\n  update(frame) {\n    super.update(frame);\n    const {\n      light\n    } = this;\n    this.coneCosNode.value = Math.cos(light.angle);\n    this.penumbraCosNode.value = Math.cos(light.angle * (1 - light.penumbra));\n    this.cutoffDistanceNode.value = light.distance;\n    this.decayExponentNode.value = light.decay;\n  }\n  getSpotAttenuation(angleCosine) {\n    const {\n      coneCosNode,\n      penumbraCosNode\n    } = this;\n    return smoothstep(coneCosNode, penumbraCosNode, angleCosine);\n  }\n  construct(builder) {\n    super.construct(builder);\n    const {\n      colorNode,\n      cutoffDistanceNode,\n      decayExponentNode,\n      light\n    } = this;\n    const lVector = objectViewPosition(light).sub(positionView); // @TODO: Add it into LightNode\n\n    const lightDirection = lVector.normalize();\n    const angleCos = lightDirection.dot(lightTargetDirection(light));\n    const spotAttenuation = this.getSpotAttenuation(angleCos);\n    const lightDistance = lVector.length();\n    const lightAttenuation = getDistanceAttenuation.call({\n      lightDistance,\n      cutoffDistance: cutoffDistanceNode,\n      decayExponent: decayExponentNode\n    });\n    const lightColor = colorNode.mul(spotAttenuation).mul(lightAttenuation);\n    const lightingModelFunctionNode = builder.context.lightingModelNode;\n    const reflectedLight = builder.context.reflectedLight;\n    if (lightingModelFunctionNode && lightingModelFunctionNode.direct) {\n      lightingModelFunctionNode.direct.call({\n        lightDirection,\n        lightColor,\n        reflectedLight\n      }, builder);\n    }\n  }\n}\nexport default SpotLightNode;\naddLightNode(SpotLight, SpotLightNode);\naddNodeClass(SpotLightNode);","map":{"version":3,"names":["AnalyticLightNode","lightTargetDirection","addLightNode","getDistanceAttenuation","uniform","smoothstep","objectViewPosition","positionView","addNodeClass","SpotLight","SpotLightNode","constructor","light","arguments","length","undefined","coneCosNode","penumbraCosNode","cutoffDistanceNode","decayExponentNode","update","frame","value","Math","cos","angle","penumbra","distance","decay","getSpotAttenuation","angleCosine","construct","builder","colorNode","lVector","sub","lightDirection","normalize","angleCos","dot","spotAttenuation","lightDistance","lightAttenuation","call","cutoffDistance","decayExponent","lightColor","mul","lightingModelFunctionNode","context","lightingModelNode","reflectedLight","direct"],"sources":["C:/Users/LENOVO/Desktop/reactjsProject/drillit/node_modules/three/examples/jsm/nodes/lighting/SpotLightNode.js"],"sourcesContent":["import AnalyticLightNode from './AnalyticLightNode.js';\r\nimport { lightTargetDirection } from './LightNode.js';\r\nimport { addLightNode } from './LightsNode.js';\r\nimport { getDistanceAttenuation } from './LightUtils.js';\r\nimport { uniform } from '../core/UniformNode.js';\r\nimport { smoothstep } from '../math/MathNode.js';\r\nimport { objectViewPosition } from '../accessors/Object3DNode.js';\r\nimport { positionView } from '../accessors/PositionNode.js';\r\nimport { addNodeClass } from '../core/Node.js';\r\n\r\nimport { SpotLight } from 'three';\r\n\r\nclass SpotLightNode extends AnalyticLightNode {\r\n\r\n\tconstructor( light = null ) {\r\n\r\n\t\tsuper( light );\r\n\r\n\t\tthis.coneCosNode = uniform( 0 );\r\n\t\tthis.penumbraCosNode = uniform( 0 );\r\n\r\n\t\tthis.cutoffDistanceNode = uniform( 0 );\r\n\t\tthis.decayExponentNode = uniform( 0 );\r\n\r\n\t}\r\n\r\n\tupdate( frame ) {\r\n\r\n\t\tsuper.update( frame );\r\n\r\n\t\tconst { light } = this;\r\n\r\n\t\tthis.coneCosNode.value = Math.cos( light.angle );\r\n\t\tthis.penumbraCosNode.value = Math.cos( light.angle * ( 1 - light.penumbra ) );\r\n\r\n\t\tthis.cutoffDistanceNode.value = light.distance;\r\n\t\tthis.decayExponentNode.value = light.decay;\r\n\r\n\t}\r\n\r\n\tgetSpotAttenuation( angleCosine ) {\r\n\r\n\t\tconst { coneCosNode, penumbraCosNode } = this;\r\n\r\n\t\treturn smoothstep( coneCosNode, penumbraCosNode, angleCosine );\r\n\r\n\t}\r\n\r\n\tconstruct( builder ) {\r\n\r\n\t\tsuper.construct( builder );\r\n\r\n\t\tconst { colorNode, cutoffDistanceNode, decayExponentNode, light } = this;\r\n\r\n\t\tconst lVector = objectViewPosition( light ).sub( positionView ); // @TODO: Add it into LightNode\r\n\r\n\t\tconst lightDirection = lVector.normalize();\r\n\t\tconst angleCos = lightDirection.dot( lightTargetDirection( light ) );\r\n\t\tconst spotAttenuation = this.getSpotAttenuation( angleCos );\r\n\r\n\t\tconst lightDistance = lVector.length();\r\n\r\n\t\tconst lightAttenuation = getDistanceAttenuation.call( {\r\n\t\t\tlightDistance,\r\n\t\t\tcutoffDistance: cutoffDistanceNode,\r\n\t\t\tdecayExponent: decayExponentNode\r\n\t\t} );\r\n\r\n\t\tconst lightColor = colorNode.mul( spotAttenuation ).mul( lightAttenuation );\r\n\r\n\t\tconst lightingModelFunctionNode = builder.context.lightingModelNode;\r\n\t\tconst reflectedLight = builder.context.reflectedLight;\r\n\r\n\t\tif ( lightingModelFunctionNode && lightingModelFunctionNode.direct ) {\r\n\r\n\t\t\tlightingModelFunctionNode.direct.call( {\r\n\t\t\t\tlightDirection,\r\n\t\t\t\tlightColor,\r\n\t\t\t\treflectedLight\r\n\t\t\t}, builder );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default SpotLightNode;\r\n\r\naddLightNode( SpotLight, SpotLightNode );\r\n\r\naddNodeClass( SpotLightNode );\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}