{"ast":null,"code":"import TempNode from '../core/TempNode.js';\nimport { addNodeClass } from '../core/Node.js';\nimport { ShaderNode, nodeObject, float, mat3 } from '../shadernode/ShaderNode.js';\nimport { NoToneMapping, LinearToneMapping, ReinhardToneMapping, CineonToneMapping, ACESFilmicToneMapping } from 'three';\n\n// exposure only\nconst LinearToneMappingNode = new ShaderNode(_ref => {\n  let {\n    color,\n    exposure\n  } = _ref;\n  return color.mul(exposure).clamp();\n});\n\n// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf\nconst ReinhardToneMappingNode = new ShaderNode(_ref2 => {\n  let {\n    color,\n    exposure\n  } = _ref2;\n  color = color.mul(exposure);\n  return color.div(color.add(1.0)).clamp();\n});\n\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\nconst OptimizedCineonToneMappingNode = new ShaderNode(_ref3 => {\n  let {\n    color,\n    exposure\n  } = _ref3;\n  // optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n  color = color.mul(exposure);\n  color = color.sub(0.004).max(0.0);\n  const a = color.mul(color.mul(6.2).add(0.5));\n  const b = color.mul(color.mul(6.2).add(1.7)).add(0.06);\n  return a.div(b).pow(2.2);\n});\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nconst RRTAndODTFit = new ShaderNode(_ref4 => {\n  let {\n    color\n  } = _ref4;\n  const a = color.mul(color.add(0.0245786)).sub(0.000090537);\n  const b = color.mul(color.add(0.4329510).mul(0.983729)).add(0.238081);\n  return a.div(b);\n});\n\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\nconst ACESFilmicToneMappingNode = new ShaderNode(_ref5 => {\n  let {\n    color,\n    exposure\n  } = _ref5;\n  // sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\n  const ACESInputMat = mat3(0.59719, 0.35458, 0.04823, 0.07600, 0.90834, 0.01566, 0.02840, 0.13383, 0.83777);\n\n  // ODT_SAT => XYZ => D60_2_D65 => sRGB\n  const ACESOutputMat = mat3(1.60475, -0.53108, -0.07367, -0.10208, 1.10813, -0.00605, -0.00327, -0.07276, 1.07602);\n  color = color.mul(exposure).div(0.6);\n  color = ACESInputMat.mul(color);\n\n  // Apply RRT and ODT\n  color = RRTAndODTFit.call({\n    color\n  });\n  color = ACESOutputMat.mul(color);\n\n  // Clamp to [0, 1]\n  return color.clamp();\n});\nconst toneMappingLib = {\n  [LinearToneMapping]: LinearToneMappingNode,\n  [ReinhardToneMapping]: ReinhardToneMappingNode,\n  [CineonToneMapping]: OptimizedCineonToneMappingNode,\n  [ACESFilmicToneMapping]: ACESFilmicToneMappingNode\n};\nclass ToneMappingNode extends TempNode {\n  constructor() {\n    let toneMapping = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : NoToneMapping;\n    let exposureNode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : float(1);\n    let colorNode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    super('vec3');\n    this.toneMapping = toneMapping;\n    this.exposureNode = exposureNode;\n    this.colorNode = colorNode;\n  }\n  getCacheKey() {\n    let cacheKey = super.getCacheKey();\n    cacheKey = '{toneMapping:' + this.toneMapping + ',nodes:' + cacheKey + '}';\n    return cacheKey;\n  }\n  construct(builder) {\n    const colorNode = this.colorNode || builder.context.color;\n    const toneMapping = this.toneMapping;\n    if (toneMapping === NoToneMapping) return colorNode;\n    const toneMappingParams = {\n      exposure: this.exposureNode,\n      color: colorNode\n    };\n    const toneMappingNode = toneMappingLib[toneMapping];\n    let outputNode = null;\n    if (toneMappingNode) {\n      outputNode = toneMappingNode.call(toneMappingParams);\n    } else {\n      console.error('ToneMappingNode: Unsupported Tone Mapping configuration.', toneMapping);\n      outputNode = colorNode;\n    }\n    return outputNode;\n  }\n}\nexport default ToneMappingNode;\nexport const toneMapping = (mapping, exposure, color) => nodeObject(new ToneMappingNode(mapping, nodeObject(exposure), nodeObject(color)));\naddNodeClass(ToneMappingNode);","map":{"version":3,"names":["TempNode","addNodeClass","ShaderNode","nodeObject","float","mat3","NoToneMapping","LinearToneMapping","ReinhardToneMapping","CineonToneMapping","ACESFilmicToneMapping","LinearToneMappingNode","_ref","color","exposure","mul","clamp","ReinhardToneMappingNode","_ref2","div","add","OptimizedCineonToneMappingNode","_ref3","sub","max","a","b","pow","RRTAndODTFit","_ref4","ACESFilmicToneMappingNode","_ref5","ACESInputMat","ACESOutputMat","call","toneMappingLib","ToneMappingNode","constructor","toneMapping","arguments","length","undefined","exposureNode","colorNode","getCacheKey","cacheKey","construct","builder","context","toneMappingParams","toneMappingNode","outputNode","console","error","mapping"],"sources":["C:/Users/LENOVO/Desktop/reactjsProject/drillit/node_modules/three/examples/jsm/nodes/display/ToneMappingNode.js"],"sourcesContent":["import TempNode from '../core/TempNode.js';\r\nimport { addNodeClass } from '../core/Node.js';\r\nimport { ShaderNode, nodeObject, float, mat3 } from '../shadernode/ShaderNode.js';\r\n\r\nimport { NoToneMapping, LinearToneMapping, ReinhardToneMapping, CineonToneMapping, ACESFilmicToneMapping } from 'three';\r\n\r\n// exposure only\r\nconst LinearToneMappingNode = new ShaderNode( ( { color, exposure } ) => {\r\n\r\n\treturn color.mul( exposure ).clamp();\r\n\r\n} );\r\n\r\n// source: https://www.cs.utah.edu/docs/techreports/2002/pdf/UUCS-02-001.pdf\r\nconst ReinhardToneMappingNode = new ShaderNode( ( { color, exposure } ) => {\r\n\r\n\tcolor = color.mul( exposure );\r\n\r\n\treturn color.div( color.add( 1.0 ) ).clamp();\r\n\r\n} );\r\n\r\n// source: http://filmicworlds.com/blog/filmic-tonemapping-operators/\r\nconst OptimizedCineonToneMappingNode = new ShaderNode( ( { color, exposure } ) => {\r\n\r\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\r\n\tcolor = color.mul( exposure );\r\n\tcolor = color.sub( 0.004 ).max( 0.0 );\r\n\r\n\tconst a = color.mul( color.mul( 6.2 ).add( 0.5 ) );\r\n\tconst b = color.mul( color.mul( 6.2 ).add( 1.7 ) ).add( 0.06 );\r\n\r\n\treturn a.div( b ).pow( 2.2 );\r\n\r\n} );\r\n\r\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\r\nconst RRTAndODTFit = new ShaderNode( ( { color } ) => {\r\n\r\n\tconst a = color.mul( color.add( 0.0245786 ) ).sub( 0.000090537 );\r\n\tconst b = color.mul( color.add( 0.4329510 ).mul( 0.983729 ) ).add( 0.238081 );\r\n\r\n\treturn a.div( b );\r\n\r\n} );\r\n\r\n// source: https://github.com/selfshadow/ltc_code/blob/master/webgl/shaders/ltc/ltc_blit.fs\r\nconst ACESFilmicToneMappingNode = new ShaderNode( ( { color, exposure } ) => {\r\n\r\n\t// sRGB => XYZ => D65_2_D60 => AP1 => RRT_SAT\r\n\tconst ACESInputMat = mat3(\r\n\t\t0.59719, 0.35458, 0.04823,\r\n\t\t0.07600, 0.90834, 0.01566,\r\n\t\t0.02840, 0.13383, 0.83777\r\n\t);\r\n\r\n\t// ODT_SAT => XYZ => D60_2_D65 => sRGB\r\n\tconst ACESOutputMat = mat3(\r\n\t\t1.60475, - 0.53108, - 0.07367,\r\n\t\t- 0.10208, 1.10813, - 0.00605,\r\n\t\t- 0.00327, - 0.07276, 1.07602\r\n\t);\r\n\r\n\tcolor = color.mul( exposure ).div( 0.6 );\r\n\r\n\tcolor = ACESInputMat.mul( color );\r\n\r\n\t// Apply RRT and ODT\r\n\tcolor = RRTAndODTFit.call( { color } );\r\n\r\n\tcolor = ACESOutputMat.mul( color );\r\n\r\n\t// Clamp to [0, 1]\r\n\treturn color.clamp();\r\n\r\n} );\r\n\r\nconst toneMappingLib = {\r\n\t[ LinearToneMapping ]: LinearToneMappingNode,\r\n\t[ ReinhardToneMapping ]: ReinhardToneMappingNode,\r\n\t[ CineonToneMapping ]: OptimizedCineonToneMappingNode,\r\n\t[ ACESFilmicToneMapping ]: ACESFilmicToneMappingNode\r\n};\r\n\r\nclass ToneMappingNode extends TempNode {\r\n\r\n\tconstructor( toneMapping = NoToneMapping, exposureNode = float( 1 ), colorNode = null ) {\r\n\r\n\t\tsuper( 'vec3' );\r\n\r\n\t\tthis.toneMapping = toneMapping;\r\n\r\n\t\tthis.exposureNode = exposureNode;\r\n\t\tthis.colorNode = colorNode;\r\n\r\n\t}\r\n\r\n\tgetCacheKey() {\r\n\r\n\t\tlet cacheKey = super.getCacheKey();\r\n\t\tcacheKey = '{toneMapping:' + this.toneMapping + ',nodes:' + cacheKey + '}';\r\n\r\n\t\treturn cacheKey;\r\n\r\n\t}\r\n\r\n\tconstruct( builder ) {\r\n\r\n\t\tconst colorNode = this.colorNode || builder.context.color;\r\n\t\tconst toneMapping = this.toneMapping;\r\n\r\n\t\tif ( toneMapping === NoToneMapping ) return colorNode;\r\n\r\n\t\tconst toneMappingParams = { exposure: this.exposureNode, color: colorNode };\r\n\t\tconst toneMappingNode = toneMappingLib[ toneMapping ];\r\n\r\n\t\tlet outputNode = null;\r\n\r\n\t\tif ( toneMappingNode ) {\r\n\r\n\t\t\toutputNode = toneMappingNode.call( toneMappingParams );\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.error( 'ToneMappingNode: Unsupported Tone Mapping configuration.', toneMapping );\r\n\r\n\t\t\toutputNode = colorNode;\r\n\r\n\t\t}\r\n\r\n\t\treturn outputNode;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default ToneMappingNode;\r\n\r\nexport const toneMapping = ( mapping, exposure, color ) => nodeObject( new ToneMappingNode( mapping, nodeObject( exposure ), nodeObject( color ) ) );\r\n\r\naddNodeClass( ToneMappingNode );\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}