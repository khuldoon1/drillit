{"ast":null,"code":"import Node from '../core/Node.js';\nimport AnalyticLightNode from './AnalyticLightNode.js';\nimport { nodeObject, nodeProxy } from '../shadernode/ShaderNode.js';\nconst LightNodes = new WeakMap();\nconst sortLights = lights => {\n  return lights.sort((a, b) => a.id - b.id);\n};\nclass LightsNode extends Node {\n  constructor() {\n    let lightNodes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    super('vec3');\n    this.lightNodes = lightNodes;\n    this._hash = null;\n  }\n  get hasLight() {\n    return this.lightNodes.length > 0;\n  }\n  construct(builder) {\n    const lightNodes = this.lightNodes;\n    for (const lightNode of lightNodes) {\n      lightNode.build(builder);\n    }\n  }\n  getHash(builder) {\n    if (this._hash === null) {\n      let hash = '';\n      const lightNodes = this.lightNodes;\n      for (const lightNode of lightNodes) {\n        hash += lightNode.getHash(builder) + ' ';\n      }\n      this._hash = hash;\n    }\n    return this._hash;\n  }\n  getLightNodeByHash(hash) {\n    const lightNodes = this.lightNodes;\n    for (const lightNode of lightNodes) {\n      if (lightNode.light.uuid === hash) {\n        return lightNode;\n      }\n    }\n    return null;\n  }\n  fromLights() {\n    let lights = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    const lightNodes = [];\n    lights = sortLights(lights);\n    for (const light of lights) {\n      let lightNode = this.getLightNodeByHash(light.uuid);\n      if (lightNode === null) {\n        const lightClass = light.constructor;\n        const lightNodeClass = LightNodes.has(lightClass) ? LightNodes.get(lightClass) : AnalyticLightNode;\n        lightNode = nodeObject(new lightNodeClass(light));\n      }\n      lightNodes.push(lightNode);\n    }\n    this.lightNodes = lightNodes;\n    this._hash = null;\n    return this;\n  }\n}\nexport default LightsNode;\nexport const lights = lights => nodeObject(new LightsNode().fromLights(lights));\nexport const lightsWithoutWrap = nodeProxy(LightsNode);\nexport function addLightNode(lightClass, lightNodeClass) {\n  if (LightNodes.has(lightClass)) throw new Error(`Redefinition of light node ${lightNodeClass.name}`);\n  if (typeof lightClass !== 'function' || !lightClass.name) throw new Error(`Light ${lightClass.name} is not a class`);\n  if (typeof lightNodeClass !== 'function' || !lightNodeClass.name) throw new Error(`Light node ${lightNodeClass.name} is not a class`);\n  LightNodes.set(lightClass, lightNodeClass);\n}","map":{"version":3,"names":["Node","AnalyticLightNode","nodeObject","nodeProxy","LightNodes","WeakMap","sortLights","lights","sort","a","b","id","LightsNode","constructor","lightNodes","arguments","length","undefined","_hash","hasLight","construct","builder","lightNode","build","getHash","hash","getLightNodeByHash","light","uuid","fromLights","lightClass","lightNodeClass","has","get","push","lightsWithoutWrap","addLightNode","Error","name","set"],"sources":["C:/Users/LENOVO/Desktop/reactjsProject/drillit/node_modules/three/examples/jsm/nodes/lighting/LightsNode.js"],"sourcesContent":["import Node from '../core/Node.js';\r\nimport AnalyticLightNode from './AnalyticLightNode.js';\r\nimport { nodeObject, nodeProxy } from '../shadernode/ShaderNode.js';\r\n\r\nconst LightNodes = new WeakMap();\r\n\r\nconst sortLights = ( lights ) => {\r\n\r\n\treturn lights.sort( ( a, b ) => a.id - b.id );\r\n\r\n};\r\n\r\nclass LightsNode extends Node {\r\n\r\n\tconstructor( lightNodes = [] ) {\r\n\r\n\t\tsuper( 'vec3' );\r\n\r\n\t\tthis.lightNodes = lightNodes;\r\n\r\n\t\tthis._hash = null;\r\n\r\n\t}\r\n\r\n\tget hasLight() {\r\n\r\n\t\treturn this.lightNodes.length > 0;\r\n\r\n\t}\r\n\r\n\tconstruct( builder ) {\r\n\r\n\t\tconst lightNodes = this.lightNodes;\r\n\r\n\t\tfor ( const lightNode of lightNodes ) {\r\n\r\n\t\t\tlightNode.build( builder );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tgetHash( builder ) {\r\n\r\n\t\tif ( this._hash === null ) {\r\n\r\n\t\t\tlet hash = '';\r\n\r\n\t\t\tconst lightNodes = this.lightNodes;\r\n\r\n\t\t\tfor ( const lightNode of lightNodes ) {\r\n\r\n\t\t\t\thash += lightNode.getHash( builder ) + ' ';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis._hash = hash;\r\n\r\n\t\t}\r\n\r\n\t\treturn this._hash;\r\n\r\n\t}\r\n\r\n\tgetLightNodeByHash( hash ) {\r\n\r\n\t\tconst lightNodes = this.lightNodes;\r\n\r\n\t\tfor ( const lightNode of lightNodes ) {\r\n\r\n\t\t\tif ( lightNode.light.uuid === hash ) {\r\n\r\n\t\t\t\treturn lightNode;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\tfromLights( lights = [] ) {\r\n\r\n\t\tconst lightNodes = [];\r\n\r\n\t\tlights = sortLights( lights );\r\n\r\n\t\tfor ( const light of lights ) {\r\n\r\n\t\t\tlet lightNode = this.getLightNodeByHash( light.uuid );\r\n\r\n\t\t\tif ( lightNode === null ) {\r\n\r\n\t\t\t\tconst lightClass = light.constructor;\r\n\t\t\t\tconst lightNodeClass = LightNodes.has( lightClass ) ? LightNodes.get( lightClass ) : AnalyticLightNode;\r\n\r\n\t\t\t\tlightNode = nodeObject( new lightNodeClass( light ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlightNodes.push( lightNode );\r\n\r\n\t\t}\r\n\r\n\t\tthis.lightNodes = lightNodes;\r\n\t\tthis._hash = null;\r\n\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default LightsNode;\r\n\r\nexport const lights = ( lights ) => nodeObject( new LightsNode().fromLights( lights ) );\r\nexport const lightsWithoutWrap = nodeProxy( LightsNode );\r\n\r\nexport function addLightNode( lightClass, lightNodeClass ) {\r\n\r\n\tif ( LightNodes.has( lightClass ) ) throw new Error( `Redefinition of light node ${ lightNodeClass.name }` );\r\n\tif ( typeof lightClass !== 'function' || ! lightClass.name ) throw new Error( `Light ${ lightClass.name } is not a class` );\r\n\tif ( typeof lightNodeClass !== 'function' || ! lightNodeClass.name ) throw new Error( `Light node ${ lightNodeClass.name } is not a class` );\r\n\r\n\tLightNodes.set( lightClass, lightNodeClass );\r\n\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}